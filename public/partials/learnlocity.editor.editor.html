<div class='container-fluid'>
  <div class='row editorSection'>
    <div class='col-md-10 padding-left-none'>
      <strong style='font-size:125%'>Selected Quest:</strong> {{quest.title}}&nbsp;<strong class='label label-primary'>{{questMissionsComplete}} of {{questMissionsTotal}} missions completed ({{questPercentComplete()}}%)</strong>
    </div>
    <div class='col-md-2'>
      <div style='float:right'>        
        <button type='button' class='btn btn-default btn-sm' ng-click='questVisible = !questVisible'><i class='glyphicon glyphicon-eye-open' ng-show='!questVisible'></i><i class='glyphicon glyphicon-eye-close' ng-show='questVisible'></i> <span ng-show='!questVisible'>Show Quest</span><span ng-show='questVisible'>Hide Quest</span>
        </button>
      </div>
    </div>
  </div>
  <div class='row' ng-show='questVisible' style='padding: 5px; background: mediumspringgreen'>
    {{quest.description}}
    <h4>Missions:</h4>
    <div style='padding-top:5px'>
      <accordion close-others="true"> 
        <accordion-group is-open='false' ng-repeat='mission in missions'>
          <accordion-heading>
                <i class="pull-right glyphicon glyphicon-chevron-right"></i> {{mission.title}}
            </accordion-heading>
            {{mission.description}}
            <br />
          <button class='btn btn-success btn-sm' ng-click='stepLoad(mission.href)'>Load Mission <i class='glyphicon glyphicon-play'></i></button>
        </accordion-group>
      </accordion>
    </div>
  </div>
  <div class='row editorSection' id='step'>
    <div class='col-md-11 padding-left-none'>
        <strong style='font-size:125%'>Current Mission:</strong> {{mission.title}}
    </div>      
    <div class='col-md-1'>      
      <div style='float:right'>
        <button type='button' class='btn btn-default btn-sm' ng-click='stepVisible = !stepVisible'><i class='glyphicon glyphicon-eye-open' ng-show='!stepVisible'></i><i class='glyphicon glyphicon-eye-close' ng-show='stepVisible'></i> <span ng-show='!stepVisible'>Show Mission</span><span ng-show='stepVisible'>Hide Mission</span>
        </button>
      </div>
    </div>
  </div>
  <div class='row'>
    <div class='col-md-12 instruction' ng-if='stepVisible' ng-bind-html='mission.story'></div>  
  </div>
  <div class='row editorSection'>
    <div class='col-md-11 padding-left-none'>
      <strong style='font-size:125%'>Mission Controls</strong>      
      <div class='btn-group' ng-show='controlsVisible'>
        <button type='button' 
                  class='btn btn-primary' 
                  ng-click='save()'><i class='glyphicon glyphicon-floppy-save'></i> Save</button>
        <button type='button' 
          class='btn btn-info'
          ng-model='displays.html'
          btn-checkbox><img src="http://www.w3.org/html/logo/downloads/HTML5_Badge_512.png" height="18" width="18" /> HTML</button>
        <button type='button' 
          class='btn btn-info'
          ng-model='displays.css'
          btn-checkbox><img src="http://blogs.msdn.com/cfs-filesystemfile.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-13-metablogapi/2158.CSS3_2D00_Logo_5F00_6972ADFA.png" height="18" width="18" /> CSS</button>
        <button type='button'
          class='btn btn-info'
          ng-model='displays.js'
          btn-checkbox><img src="http://i.stack.imgur.com/Mmww2.png" height="18" width="18" /> JS</button>
        <div class="btn-group">
          <button 
            type="button" 
            class="btn btn-primary"
            ng-click='previewToggle()'
            ><i class='glyphicon glyphicon-eye-open' ng-show='!displays.preview'></i><i class='glyphicon glyphicon-eye-close' ng-show='displays.preview'></i> Results</button>
          <button type='button' 
            class='btn btn-primary'
            ng-click='preview()'
            ng-show='displays.preview && !update.whenTyping'
            ><i class='glyphicon glyphicon-refresh'></i> Update Preview</button>
          <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
            <span class="caret"></span>
            <span class="sr-only">Toggle Dropdown</span>
          </button>
          <ul class="dropdown-menu dropdown-menu-form" role="menu">
            <li>
                <label class='checkbox'><input type='checkbox' ng-model='update.whenTyping' /> Auto-refresh?</label>
            </li>
            <li>
                <label class='checkbox'><input type='checkbox' ng-model='update.previewBelow' /> Preview below?</label>
            </li> 
          </ul>
        </div>
      </div>
    </div>
    <div class='col-md-1'>     
      <div style='float:right'>        
        <button type='button' class='btn btn-default btn-sm' ng-click='controlsVisible = !controlsVisible'><i class='glyphicon glyphicon-eye-open' ng-show='!controlsVisible'></i><i class='glyphicon glyphicon-eye-close' ng-show='controlsVisible'></i> <span ng-show='!controlsVisible'>Show Controls</span><span ng-show='controlsVisible'>Hide Controls</span>
        </button>
      </div>
    </div>        
  </div>
  <div class='row' ng-show='controlsVisible'>
    <div class='editor {{getEditorsClass()}}' ng-show='displays.html'>
      <div style='background: #F06428; color: black;'><strong>HTML</strong> <i class='glyphicon glyphicon-edit'></i></div>
      <div class='ace_wrapper'>        
        <div style='margin-top: 0px' ui-ace="{
          theme: 'chrome',
          useWrapMode: true,
          showGutter: true,
          mode: 'html',
          onLoad: htmlLoaded
        }" ng-model="code.code['html']"></div>
      </div>
    </div>
    <div class='editor {{getEditorsClass()}}' ng-show='displays.css'>
      <div style='background: #3B9ADB; color: black;'><strong>CSS</strong> <i class='glyphicon glyphicon-edit'></i></div>
      <div class='ace_wrapper'>
        <div ui-ace="{
          theme: 'chrome',
          useWrapMode: true,
          showGutter: true,
          mode: 'css',
          onLoad: cssLoaded
        }" ng-model="code.code['css']"></div>
      </div>
    </div>
    <div class='editor {{getEditorsClass()}}' ng-show='displays.js'>
      <div style='background: #F0DB4F; color: black'><strong>JS</strong> <i class='glyphicon glyphicon-edit'></i></div>
      <div class='ace_wrapper'>    
        <div ui-ace="{
          theme: 'chrome',
          useWrapMode: true,
          showGutter: true,
          mode: 'javascript',
          onLoad: jsLoaded
        }" ng-model="code.code['js']"></div>
      </div>
    </div>
    <div class='editor {{getPreviewClass()}}' ng-show='displays.preview'>
      <div><strong>Preview</strong> <i class='glyphicon glyphicon-eye-open'></i></div>
      <iframe class='preview' style='width: 100%;border: 2px double darkgray' id='{{code.userName}}'></iframe>
    </div>    
  </div>
</div>